{"version":3,"file":"static/js/373.ea8b8477.chunk.js","mappings":"2NAQe,SAASA,EAAT,GAA8B,IAJ7BC,EAAGC,EAAGC,EAIeC,EAAO,EAAPA,KAC7BC,EAAO,GACPC,EAAW,CAAC,EAEZC,EAAkB,CAAoB,IAAnBH,EAAKI,WAAW,IAR3BP,GAQ4C,IAAIQ,KAAO,IARpDP,EAQ6E,IAAnBE,EAAKI,WAAW,GAAQ,IAR/EL,EAQwG,IAAnBC,EAAKI,WAAW,GAPhHE,KAAKC,IAAIT,EAAGQ,KAAKE,IAAIT,EAAGF,MA8C/B,OArCAG,EAAKS,SAASC,SAAQ,SAACC,GACnBA,EAAQC,YAAYF,SAAQ,SAACG,GACzBX,EAAWW,EAAIC,eAAc,CAChC,GACJ,IACDZ,EAAW,kBACJa,OAAOC,KAAKd,GAAYe,KAAI,SAACpB,GAAD,OAAQA,CAAR,KADxB,CAEPM,EAAgB,GAChBA,EAAgB,GAChBe,MACFC,OAEFnB,EAAKS,SAASC,SAAQ,SAACC,EAASS,GAC5B,IAAIC,EAAU,EACVC,EAAS,EAYb,IAVAX,EAAQC,YAAYF,SAAQ,SAACG,GACzB,KAAMX,EAAWoB,GAAUT,EAAIC,aAAcQ,IACzCrB,EAAOsB,KAAK,CACRT,aAAcZ,EAAWoB,GACzBE,MAAOH,EACPI,KAAM,GAAGL,IAGjBC,GAAWR,EAAIa,YAClB,IACKJ,EAASpB,EAAWyB,OAAO,EAAGL,IAChCrB,EAAOsB,KAAK,CACRT,aAAcZ,EAAWoB,GACzBE,MAAOH,EACPI,KAAM,GAAGL,GAGpB,KAKG,SAAC,IAAD,CACIQ,OAAQ,IACR5B,KAAMC,EACN4B,OAAO,eAAeC,OAAO,QAAQC,YAAY,OACjDC,SAAS,KACTC,OAAQ,CACJC,OAAQ,aACRC,SAAU,OAEdC,KAAM,CACFX,KAAM,CACFY,UAAW,SAACxC,GAAD,OAAQG,EAAKS,SAASZ,IAAM,CAACyC,SAAU,OAAOA,QAA9C,GAEfxB,aAAc,CACVyB,KAAM,SACNC,SAAUrC,EAAgB,GAC1BsC,SAAUtC,EAAgB,GAC1BkC,UAAW,SAACxC,GAAD,OAAO6C,EAAAA,EAAAA,IAAU7C,EAAE,IAAnB,KAK9B,C","sources":["widget/TopStarPlot.js"],"sourcesContent":["import {Line} from '@ant-design/plots';\r\n\r\nimport {format_ts} from '../utils';\r\n\r\nfunction minmax(x, a, b) {\r\n    return Math.max(a, Math.min(b, x));\r\n}\r\n\r\nexport default function TopStarPlot({data}) {\r\n    let points=[];\r\n    let timepoints={};\r\n\r\n    let time_range_disp = [data.time_range[0]*1000, minmax(+new Date()+1000, data.time_range[0]*1000+1000, data.time_range[1]*1000)];\r\n\r\n    data.topstars.forEach((topstar) => {\r\n        topstar.submissions.forEach((sub) => {\r\n            timepoints[sub.timestamp_ms]=true;\r\n        });\r\n    });\r\n    timepoints=[\r\n        ...Object.keys(timepoints).map((x) => +x),\r\n        time_range_disp[0],\r\n        time_range_disp[1],\r\n        Infinity,\r\n    ].sort();\r\n\r\n    data.topstars.forEach((topstar, idx) => {\r\n        let tot_score=0;\r\n        let time_idx=0;\r\n\r\n        topstar.submissions.forEach((sub) => {\r\n            for(; timepoints[time_idx]<sub.timestamp_ms; time_idx++) {\r\n                points.push({\r\n                    timestamp_ms: timepoints[time_idx],\r\n                    score: tot_score,\r\n                    idx0: ''+idx,\r\n                });\r\n            }\r\n            tot_score+=sub.gained_score;\r\n        });\r\n        for(; time_idx<timepoints.length-1; time_idx++) {\r\n            points.push({\r\n                timestamp_ms: timepoints[time_idx],\r\n                score: tot_score,\r\n                idx0: ''+idx,\r\n            });\r\n        }\r\n    });\r\n\r\n    //console.log('! render chart', data, timepoints.map((x)=>new Date(x)), points);\r\n\r\n    return (\r\n        <Line\r\n            height={350}\r\n            data={points}\r\n            xField=\"timestamp_ms\" yField=\"score\" seriesField=\"idx0\"\r\n            stepType=\"hv\"\r\n            legend={{\r\n                layout: 'horizontal',\r\n                position: 'top',\r\n            }}\r\n            meta={{\r\n                idx0: {\r\n                    formatter: (x) => (data.topstars[x] || {nickname: '--'}).nickname,\r\n                },\r\n                timestamp_ms: {\r\n                    type: 'linear',\r\n                    minLimit: time_range_disp[0],\r\n                    maxLimit: time_range_disp[1],\r\n                    formatter: (x) => format_ts(x/1000),\r\n                }\r\n            }}\r\n        />\r\n    );\r\n}"],"names":["TopStarPlot","x","a","b","data","points","timepoints","time_range_disp","time_range","Date","Math","max","min","topstars","forEach","topstar","submissions","sub","timestamp_ms","Object","keys","map","Infinity","sort","idx","tot_score","time_idx","push","score","idx0","gained_score","length","height","xField","yField","seriesField","stepType","legend","layout","position","meta","formatter","nickname","type","minLimit","maxLimit","format_ts"],"sourceRoot":""}